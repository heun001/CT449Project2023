{"ast":null,"code":"import \"core-js/modules/es.array.unshift.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"../../public/assets/css/chat.css\";\nimport axios from \"axios\";\nimport swal from \"sweetalert2\";\nexport default {\n  data() {\n    return {\n      message: \"\",\n      page: 0,\n      email: this.$route.params.email,\n      messages: [],\n      receiver: null,\n      attachment: null\n    };\n  },\n  methods: {\n    fileSelected: function () {\n      const files = event.target.files;\n      if (files.length > 0) {\n        this.attachment = files[0];\n      }\n    },\n    selectFile: function () {\n      document.getElementById(\"attachment\").click();\n    },\n    getMessageTime: function (time) {\n      const dateObj = new Date(time);\n      let timeStr = dateObj.getFullYear() + \"-\" + (dateObj.getMonth() + 1) + \"-\" + dateObj.getDate() + \" \" + dateObj.getHours() + \":\" + dateObj.getMinutes() + \":\" + dateObj.getSeconds();\n      return timeStr;\n    },\n    getData: async function () {\n      if (this.email == null) {\n        return;\n      }\n      const formData = new FormData();\n      formData.append(\"email\", this.email);\n      formData.append(\"page\", this.page);\n      const response = await axios.post(this.$apiURL + \"/chat/fetch\", formData, {\n        headers: this.$headers\n      });\n      // console.log(response)\n\n      if (response.data.status == \"success\") {\n        for (let a = 0; a < response.data.messages.length; a++) {\n          this.messages.unshift(response.data.messages[a]);\n        }\n        this.receiver = response.data.receiver;\n        this.user = response.data.user;\n      } else {\n        swal.fire(\"Error\", response.data.message, \"error\");\n      }\n    },\n    sendMessage: async function () {\n      const formData = new FormData();\n      formData.append(\"email\", this.email);\n      formData.append(\"message\", this.message);\n      const response = await axios.post(this.$apiURL + \"/chat/send\", formData, {\n        headers: this.$headers\n      });\n      // console.log(response)\n\n      if (response.data.status == \"success\") {\n        this.messages.push(response.data.messageObject);\n      } else {\n        swal.fire(\"Error\", response.data.message, \"error\");\n      }\n    }\n  },\n  mounted() {\n    this.getData();\n  }\n};","map":{"version":3,"names":["axios","swal","data","message","page","email","$route","params","messages","receiver","attachment","methods","fileSelected","files","event","target","length","selectFile","document","getElementById","click","getMessageTime","time","dateObj","Date","timeStr","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","getData","formData","FormData","append","response","post","$apiURL","headers","$headers","status","a","unshift","user","fire","sendMessage","push","messageObject","mounted"],"sources":["D:\\2023\\2023_PTUDW\\chat-station-mevn-free\\chat-station-mevn-free\\web\\src\\components\\ChatComponent.vue"],"sourcesContent":["<template>\r\n    <div class=\"container\">\r\n        <div class=\"row clearfix\">\r\n            <div class=\"col-lg-12\">\r\n                <div class=\"card chat-app\">\r\n                    <div class=\"chat\">\r\n                        <div class=\"chat-header clearfix\">\r\n                            <div class=\"row\">\r\n                                <div class=\"col-lg-6\">\r\n                                    <a href=\"javascript:void(0);\" data-toggle=\"modal\" data-target=\"#view_info\">\r\n                                        <img src=\"https://bootdey.com/img/Content/avatar/avatar2.png\" alt=\"avatar\">\r\n                                    </a>\r\n\r\n                                    <div class=\"chat-about\">\r\n                                        <h6 class=\"m-b-0 text-white\" v-if=\"receiver != null\" v-text=\"receiver.name\"\r\n                                            style=\"margin-bottom: 0px; position: relative; top: 10px;\"></h6>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div class=\"col-lg-6 hidden-sm text-right text-white\">\r\n                                    <span v-if=\"attachment != null\"\r\n                                        style=\"margin-right: 10px; position: relative; top: 7px;\"\r\n                                        v-text=\"attachment.name\"></span>\r\n                                    <a href=\"javascript:void(0);\" class=\"btn btn-outline-secondary pull-right text-white\"\r\n                                        v-on:click=\"selectFile\"><i class=\"fa fa-paperclip\"></i></a>\r\n                                    <input type=\"file\" id=\"attachment\" style=\"display: none;\" v-on:change=\"fileSelected\" />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div class=\"chat-history\">\r\n                            <ul class=\"m-b-0\">\r\n                                <li v-for=\"msg in messages\" class=\"clearfix\" v-bind:key=\"msg._id\">\r\n                                    <div\r\n                                        v-bind:class=\"'message-data ' + (user != null && user.email == msg.sender.email ? 'text-right' : '')\">\r\n                                        <span class=\"message-data-time text-white\"\r\n                                            v-text=\"getMessageTime(msg.createdAt)\"></span>\r\n                                        <img src=\"https://bootdey.com/img/Content/avatar/avatar7.png\" alt=\"avatar\"\r\n                                            style=\"width: 50px;\" />\r\n                                    </div>\r\n\r\n                                    <div\r\n                                        v-bind:class=\"'message ' + (user != null && user.email == msg.sender.email ? 'my-message float-right' : 'other-message')\">\r\n                                        <p v-text=\"msg.message\"\r\n                                            v-bind:class=\"(user != null && user.email == msg.sender.email ? 'text-right' : '')\"\r\n                                            style=\"margin-bottom: 0px;\"></p>\r\n                                    </div>\r\n                                </li>\r\n                            </ul>\r\n                        </div>\r\n\r\n                        <div class=\"chat-message clearfix\">\r\n                            <div class=\"input-group mb-0\">\r\n                                <div class=\"input-group mb-3\">\r\n                                    <input type=\"text\" class=\"form-control\" placeholder=\"Enter text here...\"\r\n                                        v-model=\"message\" />\r\n                                    <button class=\"btn btn-primary\" v-on:click=\"sendMessage\" type=\"button\">Send</button>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n \r\n<script>\r\n\r\nimport \"../../public/assets/css/chat.css\"\r\nimport axios from \"axios\"\r\nimport swal from \"sweetalert2\"\r\n\r\nexport default {\r\n    data() {\r\n        return {\r\n            message: \"\",\r\n            page: 0,\r\n            email: this.$route.params.email,\r\n\r\n            messages: [],\r\n            receiver: null,\r\n\r\n            attachment: null,\r\n        }\r\n    },\r\n    methods: {\r\n\r\n        fileSelected: function () {\r\n            const files = event.target.files\r\n            if (files.length > 0) {\r\n                this.attachment = files[0]\r\n            }\r\n        },\r\n\r\n        selectFile: function () {\r\n            document.getElementById(\"attachment\").click()\r\n        },\r\n\r\n        getMessageTime: function (time) {\r\n            const dateObj = new Date(time)\r\n            let timeStr = dateObj.getFullYear() + \"-\" + (dateObj.getMonth() + 1) + \"-\" + dateObj.getDate() + \" \" + dateObj.getHours() + \":\" + dateObj.getMinutes() + \":\" + dateObj.getSeconds()\r\n            return timeStr\r\n        },\r\n\r\n        getData: async function () {\r\n            if (this.email == null) {\r\n                return\r\n            }\r\n\r\n            const formData = new FormData()\r\n            formData.append(\"email\", this.email)\r\n            formData.append(\"page\", this.page)\r\n\r\n            const response = await axios.post(\r\n                this.$apiURL + \"/chat/fetch\",\r\n                formData,\r\n                {\r\n                    headers: this.$headers\r\n                }\r\n            )\r\n            // console.log(response)\r\n\r\n            if (response.data.status == \"success\") {\r\n                for (let a = 0; a < response.data.messages.length; a++) {\r\n                    this.messages.unshift(response.data.messages[a])\r\n                }\r\n                this.receiver = response.data.receiver\r\n                this.user = response.data.user\r\n\r\n            } else {\r\n                swal.fire(\"Error\", response.data.message, \"error\")\r\n            }\r\n        },\r\n\r\n        sendMessage: async function () {\r\n\r\n            const formData = new FormData()\r\n            formData.append(\"email\", this.email)\r\n            formData.append(\"message\", this.message)\r\n\r\n            const response = await axios.post(\r\n                this.$apiURL + \"/chat/send\",\r\n                formData,\r\n                {\r\n                    headers: this.$headers\r\n                }\r\n            )\r\n            // console.log(response)\r\n\r\n            if (response.data.status == \"success\") {\r\n                this.messages.push(response.data.messageObject)\r\n            } else {\r\n                swal.fire(\"Error\", response.data.message, \"error\")\r\n            }\r\n        },\r\n    },\r\n    mounted() {\r\n        this.getData()\r\n    }\r\n}\r\n</script>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}